"use strict";(self.webpackChunkinfonansys=self.webpackChunkinfonansys||[]).push([[744],{5744:(Y,m,s)=>{s.r(m),s.d(m,{CategoriasModule:()=>I});var n=s(665),c=s(4337);class g{constructor(a,r,o){this.id=a,this.nome=r,this.descricao=o}}var v=s(3190),d=s(7503),t=s(639),p=s(6223);let C=(()=>{class e{constructor(){this.storageKey="categorias"}loadCategorias(){const r=localStorage.getItem(this.storageKey);return r?JSON.parse(r):[]}adicionarCategoria(r){const o=this.loadCategorias();o.push(r),localStorage.setItem(this.storageKey,JSON.stringify(o))}}return e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var f=s(1502),u=s(8583);function b(e,a){1&e&&(t.TgZ(0,"div"),t._uU(1,"Campo \xe9 obrigat\xf3rio"),t.qZA())}function T(e,a){1&e&&(t.TgZ(0,"div",19),t._uU(1," O nome da categoria deve conter apenas letras. "),t.qZA())}function A(e,a){if(1&e&&(t.TgZ(0,"div",19),t.YNc(1,b,2,0,"div",20),t.YNc(2,T,2,0,"div",13),t.qZA()),2&e){const r=t.oxw();let o,i;t.xp6(1),t.Q6J("ngIf",null==(o=r.categoriaForm.get("nome"))||null==o.errors?null:o.errors.required),t.xp6(1),t.Q6J("ngIf",(null==(i=r.categoriaForm.get("nome"))?null:i.hasError("pattern"))&&(null==(i=r.categoriaForm.get("nome"))?null:i.touched))}}function F(e,a){if(1&e&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&e){const r=a.$implicit;t.xp6(1),t.Oqu(r)}}function _(e,a){if(1&e&&(t.TgZ(0,"div",21),t.TgZ(1,"strong"),t._uU(2,"Error no servidor:"),t.qZA(),t.TgZ(3,"ul"),t.YNc(4,F,2,1,"li",22),t.qZA(),t.qZA()),2&e){const r=t.oxw();t.xp6(4),t.Q6J("ngForOf",r.serverErrorMessages)}}const q=function(){return{text:"Categorias",link:"/categorias"}},x=function(e){return{text:e}},S=function(e,a){return[e,a]};let h=(()=>{class e{constructor(r,o,i,l,Z){this.categoriaService=r,this.route=o,this.router=i,this.formBuilder=l,this.webStorageService=Z,this.currentAction="",this.pageTitle="",this.serverErrorMessages=[],this.submittingForm=!1,this.categoria=new g}ngOnInit(){this.setCurrentAction(),this.buildFormCategoria(),this.loadCategoria()}cadastrar(){var r;const o=Object.assign(new g,null===(r=this.categoriaForm)||void 0===r?void 0:r.value);this.webStorageService.adicionarCategoria(o),this.categoriaService.cadastrar(o).subscribe(()=>this.actionsForSuccess(),i=>this.actionsForError(i))}editar(){var r;const o=Object.assign(new g,null===(r=this.categoriaForm)||void 0===r?void 0:r.value);this.categoriaService.editar(o).subscribe(()=>this.actionsForSuccess(),i=>this.actionsForError(i))}ngAfterContentChecked(){this.setPageTitle()}submitForm(){this.submittingForm=!0,"cadastrar"==this.currentAction?this.cadastrar():this.editar()}setCurrentAction(){this.currentAction="cadastrar"==this.route.snapshot.url[0].path?"cadastrar":"editar"}buildFormCategoria(){this.categoriaForm=this.formBuilder.group({id:[null],nome:["",[n.kI.required,n.kI.pattern(/^[a-zA-Z\s]+$/)]],descricao:[null]})}loadCategoria(){"editar"==this.currentAction&&this.route.paramMap.pipe((0,v.w)(r=>this.categoriaService.buscarPorId(Number(r.get("id"))))).subscribe(r=>{var o;this.categoria=r,null===(o=this.categoriaForm)||void 0===o||o.patchValue(r)},r=>alert("Ocorreu um erro no servidor, tente novamente mais tarde!"))}setPageTitle(){this.pageTitle="cadastrar"==this.currentAction?"Cadastrar Nova Categoria":"Editando Categoria: "+(this.categoria.nome||"")}actionsForSuccess(){d.success("Opera\xe7\xe3o realizada com sucesso"),this.router.navigate(["categorias"])}actionsForError(r){d.error("Ocorreu um erro ao processar a sua solicita\xe7\xe3o"),this.submittingForm=!1,this.serverErrorMessages=422==r.status?JSON.parse(r._body).errors:["Falha na comunica\xe7\xe3o com servidor. Por favor, tente mais tarde."]}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(p.n),t.Y36(c.gz),t.Y36(c.F0),t.Y36(n.qu),t.Y36(C))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-categoria-form"]],decls:26,vars:12,consts:[[3,"items"],[1,"row","mb-4"],[1,"col-md"],[1,"h3","border-left","pl-2"],["routerLink","/categorias",1,"btn","btn-success","float-right"],[3,"formGroup","submit"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"form-row"],[1,"form-group","col-mb-4"],["for","nome"],["type","text","id","nome","formControlName","nome",1,"form-control"],["class","text-danger",4,"ngIf"],[1,"form-group","col-md-8"],["for","descricao"],["type","text","id","descricao","formControlName","descricao",1,"form-control"],["class","alert alert-danger mt-4",4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-lg","float-right","mt-3",3,"disabled"],[1,"text-danger"],[4,"ngIf"],[1,"alert","alert-danger","mt-4"],[4,"ngFor","ngForOf"]],template:function(r,o){if(1&r&&(t._UZ(0,"app-bread-crumb",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"h3",3),t._uU(4),t.qZA(),t.qZA(),t.TgZ(5,"div",2),t.TgZ(6,"a",4),t._uU(7," Voltar "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"form",5),t.NdJ("submit",function(){return o.submitForm()}),t.TgZ(9,"div",6),t.TgZ(10,"div",7),t._uU(11," Informa\xe7\xf5es sobre a categoria "),t.qZA(),t.TgZ(12,"div",8),t.TgZ(13,"div",9),t.TgZ(14,"div",10),t.TgZ(15,"label",11),t._uU(16,"Nome"),t.qZA(),t._UZ(17,"input",12),t.YNc(18,A,3,2,"div",13),t.qZA(),t.TgZ(19,"div",14),t.TgZ(20,"label",15),t._uU(21,"Descri\xe7\xe3o"),t.qZA(),t._UZ(22,"input",16),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(23,_,5,1,"div",17),t.TgZ(24,"button",18),t._uU(25," Salvar "),t.qZA(),t.qZA()),2&r){let i;t.Q6J("items",t.WLB(9,S,t.DdM(6,q),t.VKq(7,x,o.pageTitle))),t.xp6(4),t.Oqu(o.pageTitle),t.xp6(4),t.Q6J("formGroup",o.categoriaForm),t.xp6(10),t.Q6J("ngIf",(null==(i=o.categoriaForm.get("nome"))?null:i.invalid)&&(null==(i=o.categoriaForm.get("nome"))?null:i.touched)),t.xp6(5),t.Q6J("ngIf",!o.serverErrorMessages),t.xp6(1),t.Q6J("disabled",o.categoriaForm.invalid)}},directives:[f.N,c.yS,n._Y,n.JL,n.sg,n.Fj,n.JJ,n.u,u.O5,u.sg],styles:[""]}),e})();const y=function(e){return[e,"editar"]};function U(e,a){if(1&e){const r=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t.TgZ(2,"strong"),t._uU(3),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"small"),t._uU(6),t.qZA(),t._UZ(7,"br"),t.qZA(),t.TgZ(8,"td"),t.TgZ(9,"a",8),t._uU(10,"Editar"),t.qZA(),t.TgZ(11,"button",9),t.NdJ("click",function(){const l=t.CHM(r).$implicit;return t.oxw().excluir(l)}),t._uU(12,"Excluir"),t.qZA(),t.qZA(),t.qZA()}if(2&e){const r=a.$implicit;t.xp6(3),t.Oqu(r.nome),t.xp6(3),t.Oqu(r.descricao),t.xp6(3),t.Q6J("routerLink",t.VKq(3,y,r.id))}}const E=function(){return{text:"Categorias"}},J=function(e){return[e]},N=[{path:"",component:(()=>{class e{constructor(r){this.categoriaService=r,this.categorias=[]}ngOnInit(){this.loadCategorias()}loadCategorias(){return this.categoriaService.listar().subscribe(r=>this.categorias=r,r=>alert("Erro ao carregar a lista de categorias"))}excluir(r){confirm("Deseja realmente excluir esta categoria ?")&&this.categoriaService.excluir(r.id).subscribe(()=>this.categorias=this.categorias.filter(i=>i!=r),()=>alert("Erro ao tentar excluir"))}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(p.n))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-categoria-list"]],decls:17,vars:5,consts:[[3,"items"],[1,"row","mb-4"],[1,"col-md"],[1,"h3","border-left","pl-2"],["routerLink","cadastrar",1,"btn","btn-success","float-right"],[1,"table","table-hover"],[1,"bg-primary","text-light"],[4,"ngFor","ngForOf"],[1,"btn","btn-outline-info","btn-sm","mr-2",3,"routerLink"],[1,"btn","btn-outline-danger","btn-sm",3,"click"]],template:function(r,o){1&r&&(t._UZ(0,"app-bread-crumb",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"h3",3),t._uU(4,"Categorias"),t.qZA(),t.qZA(),t.TgZ(5,"div",2),t.TgZ(6,"a",4),t._uU(7," Nova Categoria "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"table",5),t.TgZ(9,"thead"),t.TgZ(10,"tr",6),t.TgZ(11,"th"),t._uU(12,"Categoria"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"A\xe7\xf5es"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(15,"tbody"),t.YNc(16,U,13,5,"tr",7),t.qZA(),t.qZA()),2&r&&(t.Q6J("items",t.VKq(3,J,t.DdM(2,E))),t.xp6(16),t.Q6J("ngForOf",o.categorias))},directives:[f.N,c.yS,u.sg],styles:[""]}),e})()},{path:"cadastrar",component:h},{path:":id/editar",component:h}];let O=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[c.Bz.forChild(N)],c.Bz]}),e})();var M=s(4466);let I=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[M.m,O,n.UX]]}),e})()}}]);